<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Hogwarts Sorting Quiz</title>
    <link href="QuizStyle.css" rel="stylesheet" type="text/css" />
</head>
<body>

    <!--
    Sample Example Output generated by loadQuestions which gets added between the content of <div id="questions"></div>:
    <div class="question">
        <div class="title"> Question #</div>
        <div class="question-text">Am I a question?</div>
        <div class="answers">
            <label class="answer-item"><input type="radio" name="Question#" value="Gryffindor">Answer A</label>
            <label class="answer-item"><input type="radio" name="Question#" value="Ravenclaw">Answer B</label>
            <label class="answer-item"><input type="radio" name="Question#" value="Hufflepuff">Answer C</label>
            <label class="answer-item"><input type="radio" name="Question#" value="Slytherin">Answer D</label>
        </div>
    </div>
    ... x 20 questions
    -->

    <form onsubmit="return calculateHouse();">
        <div id="questions"></div>
        <button type="submit">Click me!</button>
    </form>


    <!--https://www.w3schools.com/xml/tryit.asp?filename=try_dom_xmlhttprequest_responsexml-->
    <script type="text/javascript">
        function loadQuestions() {
            var xmlRequest = new XMLHttpRequest();
            xmlRequest.onreadystatechange = function () {
                if (this.readyState === 4 && this.status === 200) {
                    var xml = xmlRequest.responseXML;

                    var html = '';

                    var questions = xml.getElementsByTagName('question');
                    for (var i = 0; i < questions.length; i++) {
                        html += '<div class="question">';

                        var title = questions[i].children[0].textContent;
                        html += '<div class="title">' + title + '</div>';

                        var questionText = questions[i].children[1].textContent;
                        html += '<div class="question-text">' + questionText + '</div>';

                        var answers = questions[i].children[2].children;

                        html += '<div class="answers">';

                        for (var j = 0; j < answers.length; j++) {
                            var house = answers[j].getAttribute('house');
                            var answerText = answers[j].children[0].textContent;

                            var answerId = title.replace(' ', '');
                            html += '<label class="answer-item"><input type="radio" name="' + answerId + '" value="' + house + '">' + answerText + '</label>';
                        }
                        html += '</div></div>';
                    }

                    document.getElementById('questions').innerHTML = html;
                }
            };
            xmlRequest.open('GET', 'Sorting.xml', true);
            xmlRequest.send();
        };


        loadQuestions();

        function calculateHouse() {

            var gryffindorScore = 0;
            var ravenclawScore = 0;
            var hufflepuffScore = 0;
            var slytherinScore = 0;

            //loop to get 20 question answers 
            for (var i = 0; i < 20; i++){
                var rbAnswers = document.getElementsByName('Question' + (i + 1)); //radiobutton answers

                for (var j = 0; j < rbAnswers.length; j++) {
                    if (rbAnswers[j].checked) {
                        switch (rbAnswers[j].value) {
                            case 'Gryffindor':
                                gryffindorScore++;
                                break;
                            case 'Ravenclaw':
                                ravenclawScore++;
                                break;
                            case 'Hufflepuff':
                                hufflepuffScore++;
                                break;
                            case 'Slytherin':
                                slytherinScore++;
                                break;
                            default:
                                alert('Undeclared House!');
                        }

                        break;
                    }
                    alert('Please answer question ' + (i + 1)); //making sure answer is selected
                    return false;
                }
            }
            //creating dictionary variable
            var results = {};
            results['Gryffindor'] = gryffindorScore; //results[key]
            results['Ravenclaw'] = ravenclawScore;
            results['Hufflepuff'] = hufflepuffScore;
            results['Slytherin'] = slytherinScore;

            var selectedHouse = '';
            var highestScore = 0;
            for (var key in results) {
                var score = results[key];
                if (highestScore < score) {
                    highestScore = score;
                    selectedHouse = key;
                }
            }
            alert(selectedHouse);


            return false;
        }

    </script>
</body>
</html>